"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const http = require("http");
const express = require("express");
const bodyParser = require("body-parser");
// Create a new express application instance
const server = express();
exports.server = server;
server.jovoApp = undefined;
server.use(bodyParser.json());
server.listen = function () {
    if (server.jovoApp) {
        server.jovoApp.initWebhook();
    }
    const s = http.createServer(this);
    return s.listen.apply(s, arguments); // eslint-disable-line
};
const verifiedServer = express();
exports.verifiedServer = verifiedServer;
verifiedServer.listen = function () {
    try {
        const verifier = require('alexa-verifier-middleware');
        const router = express.Router();
        verifiedServer.use(router);
        router.use('/webhook_alexa', verifier);
        router.use('/webhook_alexa', bodyParser.json());
        router.use('/webhook', bodyParser.json());
        const server = http.createServer(this);
        return server.listen.apply(server, arguments); // eslint-disable-line
    }
    catch (error) {
        if (error.code === 'MODULE_NOT_FOUND') {
            console.log();
            console.log('  Please install module alexa-verifier-middleware');
            console.log('  $ npm install alexa-verifier-middleware');
            console.log();
        }
        else {
            console.log(error);
        }
    }
};
//# sourceMappingURL=server.js.map